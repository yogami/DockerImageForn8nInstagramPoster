FROM n8n.io/n8n:latest

USER root
RUN apk add --no-cache python3 py3-pip && \
    pip3 install --no-cache-dir instagrapi && \
    rm -rf /var/cache/apk/*

USER node
WORKDIR /data
RUN echo '#!/bin/sh\nexec n8n worker' > /data/start.sh && chmod +x /data/start.sh
CMD ["/data/start.sh"]
